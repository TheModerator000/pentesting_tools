#!/bin/bash
#by 21y4d

GREEN='\033[0;32m'
NC='\033[0m'

#make a directories for our output from this file
mkdir Discovery
mkdir public_info

#move the ip file to Discovery for nmap scans
mv ips.txt Discovery

#change to the newly created directory
cd public_info

#First we need to take input from the user on what domain they wish to recon
read -p "What domain do you wish to recon?" company_domain

echo -e "${GREEN}***Running recon on ${NC}${company_domain}"

#Now we can begin gathering info about the DNS records
host -t ns $company_domain >> DNS_info.txt | echo -e "${NC}Completed Name Server search"
host -t a $company_domain >> DNS_info.txt | echo -e "${NC}Completed A Record search"
host -t mx $company_domain >> DNS_info.txt | echo -e "${NC}Completed Mail Exchange search"
host -t soa $company_domain >> DNS_info.txt | echo -e "${NC}Completed SOA search"

#next we are going to do some passive subdomain enumeration
echo -e "${GREEN}***Performing passive subdomain enumeration on ${NC}${company_domain}"

amass enum -passive -d $company_domain >> subdomains.txt 

wc -l subdomains.txt

echo -e "${GREEN}***Checking for valid subdomains on ${NC}${company_domain}"

cat subdomains.txt | httprobe -t 1000 subdomains.txt >> valid_subdomains.txt

wc -l valid_subdomains.txt

#Now we want to run some other preliminary tools for the given domain
echo -e "${GREEN}Performing Whois on ${NC}${company_domain}"

whois $company_domain >> whois_results.txt

echo -e "${GREEN}Performing DNS Enumeration on ${NC}${company_domain}"

dnsenum --enum --noreverse -s 1 $company_domain >> dns_enum_results.txt 

echo -e "${GREEN}Performing TheHarvester Web Scraping on ${NC}${company_domain}"

theHarvester -d $company_domain -b bing >> harvester_results.txt

#go back one directory then go to discover
cd ..

cd Discovery

#Now we want to run nmap scans
echo -e "${GREEN}***Preliminary recon scans are complete. Starting Nmap scans.${NC}"

nmap -sSV --top-ports 4000 -iL ips.txt -Pn -T4 -oA TCP
